expression_testis <- ggplot(both_mean_stats_testis %>%
mutate(Type="Transcript (mRNA)"),
aes(x=treatment, y=logcount)) +
geom_boxplot(aes(fill=treatment), width=0.5,position = position_dodge(width=0.7)) +
geom_point(aes(fill=treatment), pch=21, position = position_dodge(width = 0.9))+
facet_wrap(~igene, scales = "free", nrow=1)+
labs(fill= "Treatment",x="Treatment",y="Expression")+
theme_bw()+
geom_text(aes(x=treatment,
y=ylabelpos_e,
label=letters_e),
check_overlap = T,
size=3)+
theme(axis.title.x=element_text(size=10),
axis.title.y=element_text(size=10))+
scale_fill_manual(values=mycolours, guide="none")+
theme(strip.background=element_blank(),
strip.text.x=element_markdown(size=12))
expression_testis
expression_ovary <- ggplot(both_mean_stats_ovary %>%
mutate(Type="Transcript (mRNA)"),
aes(x=treatment, y=logcount)) +
geom_boxplot(aes(fill=treatment), width=0.5,position = position_dodge(width=0.7)) +
geom_point(aes(fill=treatment), pch=21, position = position_dodge(width = 0.9))+
facet_wrap(~igene, scales = "free", nrow=1)+
labs(fill= "Treatment",x="Treatment",y="Expression")+
theme_bw()+
geom_text(aes(x=treatment,
y=ylabelpos_e,
label=letters_e),
check_overlap = T,
size=3)+
theme(axis.title.x=element_text(size=10),
axis.title.y=element_text(size=10))+
scale_fill_manual(values=mycolours, guide="none")+
theme(strip.background=element_blank(),
strip.text.x=element_markdown(size=12))
expression_ovary
ovaryp <- ggarrange(ggarrange(NULL,
expression_ovary+
scale_y_continuous(labels = label_number(scale = 1, accuracy = 0.1))+
theme(axis.title.x=element_blank(),
plot.title = element_text(hjust = 0.5))+
ggtitle("Ovary-associated genes"),
NULL,
nrow=1,
widths=c(0.001,1,0)),
meth_ovary+
theme(strip.text.x=element_blank(),
strip.text.y=element_blank()),
corr_ovary+
scale_y_continuous(labels = label_number(scale = 1, accuracy = 0.1))+
theme(strip.text.x=element_blank(),
strip.text.y=element_blank()),
nrow=3,
heights=c(0.9,2,2))
ovaryp
testisp <- ggarrange(ggarrange(NULL,
annotate_figure(expression_testis+
scale_y_continuous(labels = label_number(scale = 1, accuracy = 0.1))+
theme(axis.title.x=element_blank(),
axis.title.y=element_blank(),
plot.title = element_text(hjust = 0.5))+
ggtitle("Testis-associated genes"),
right=text_grob("Whole transcript", size=9, rot=270, vjust=1)),
NULL,
nrow=1,
widths=c(0.0005,1,0.005)),
meth_testis+
theme(strip.text.x=element_blank(),
axis.title.y=element_blank()),
corr_testis+
scale_y_continuous(labels = label_number(scale = 1, accuracy = 0.1))+
theme(strip.text.x=element_blank(),
axis.title.y=element_blank()),
nrow=3,
heights=c(0.9,2,2))
testisp
# p <- annotate_figure(ggarrange(ovaryp, testisp, ncol=2),
#                      between=text_grob("|", color = "black", face = "bold", size = 20))
line <- "________________________________________________________________________________________________________________________________________________________________________"
p <- ggarrange(annotate_figure(ovaryp,
right=text_grob(line,
size=9,
rot=90)),
testisp,
ncol=2)
p
testisp <- ggarrange(ggarrange(NULL,
annotate_figure(expression_testis+
scale_y_continuous(labels = label_number(scale = 1, accuracy = 0.1))+
theme(axis.title.x=element_blank(),
axis.title.y=element_blank(),
plot.title = element_text(hjust = 0.5))+
ggtitle("Testis-associated genes"),
right=text_grob("  Whole transcript", size=9, rot=270, vjust=1)),
NULL,
nrow=1,
widths=c(0.0005,1,0.005)),
meth_testis+
theme(strip.text.x=element_blank(),
axis.title.y=element_blank()),
corr_testis+
scale_y_continuous(labels = label_number(scale = 1, accuracy = 0.1))+
theme(strip.text.x=element_blank(),
axis.title.y=element_blank()),
nrow=3,
heights=c(0.9,2,2))
testisp
# p <- annotate_figure(ggarrange(ovaryp, testisp, ncol=2),
#                      between=text_grob("|", color = "black", face = "bold", size = 20))
line <- "________________________________________________________________________________________________________________________________________________________________________"
p <- ggarrange(annotate_figure(ovaryp,
right=text_grob(line,
size=9,
rot=90)),
testisp,
ncol=2)
p
testisp <- ggarrange(ggarrange(NULL,
annotate_figure(expression_testis+
scale_y_continuous(labels = label_number(scale = 1, accuracy = 0.1))+
theme(axis.title.x=element_blank(),
axis.title.y=element_blank(),
plot.title = element_text(hjust = 0.5))+
ggtitle("Testis-associated genes"),
right=text_grob("  Whole transcript", size=9, rot=270, vjust=1)),
NULL,
nrow=1,
widths=c(0.0005,1,0.005)),
meth_testis+
theme(strip.text.x=element_blank(),
axis.title.y=element_blank()),
corr_testis+
scale_y_continuous(labels = label_number(scale = 1, accuracy = 0.1))+
theme(strip.text.x=element_blank(),
axis.title.y=element_blank()),
nrow=3,
heights=c(0.9,1.9,2))
testisp
ovaryp <- ggarrange(ggarrange(NULL,
expression_ovary+
scale_y_continuous(labels = label_number(scale = 1, accuracy = 0.1))+
theme(axis.title.x=element_blank(),
plot.title = element_text(hjust = 0.5))+
ggtitle("Ovary-associated genes"),
NULL,
nrow=1,
widths=c(0.001,1,0)),
meth_ovary+
theme(strip.text.x=element_blank(),
strip.text.y=element_blank()),
corr_ovary+
scale_y_continuous(labels = label_number(scale = 1, accuracy = 0.1))+
theme(strip.text.x=element_blank(),
strip.text.y=element_blank()),
nrow=3,
heights=c(0.9,1.9,2))
ovaryp
# p <- annotate_figure(ggarrange(ovaryp, testisp, ncol=2),
#                      between=text_grob("|", color = "black", face = "bold", size = 20))
line <- "________________________________________________________________________________________________________________________________________________________________________"
p <- ggarrange(annotate_figure(ovaryp,
right=text_grob(line,
size=9,
rot=90)),
testisp,
ncol=2)
p
## the hill
## change x axis titles to something like %5mC and log(counts) ...
## ...and then add annotations for "Expression", "Methylation", and "Correlations"
## add legend on bottom
##
ovaryp <- ggarrange(ggarrange(NULL,
expression_ovary+
scale_y_continuous(labels = label_number(scale = 1, accuracy = 0.1))+
theme(axis.title.x=element_blank(),
plot.title = element_text(hjust = 0.5))+
ggtitle("Ovary-associated genes"),
NULL,
nrow=1,
widths=c(0.001,1,0)),
meth_ovary+
theme(strip.text.x=element_blank(),
strip.text.y=element_blank()),
corr_ovary+
scale_y_continuous(labels = label_number(scale = 1, accuracy = 0.1))+
theme(strip.text.x=element_blank(),
strip.text.y=element_blank()),
nrow=3,
heights=c(0.9,1.8,1.9))
ovaryp
testisp <- ggarrange(ggarrange(NULL,
annotate_figure(expression_testis+
scale_y_continuous(labels = label_number(scale = 1, accuracy = 0.1))+
theme(axis.title.x=element_blank(),
axis.title.y=element_blank(),
plot.title = element_text(hjust = 0.5))+
ggtitle("Testis-associated genes"),
right=text_grob("  Whole transcript", size=9, rot=270, vjust=1)),
NULL,
nrow=1,
widths=c(0.0005,1,0.005)),
meth_testis+
theme(strip.text.x=element_blank(),
axis.title.y=element_blank()),
corr_testis+
scale_y_continuous(labels = label_number(scale = 1, accuracy = 0.1))+
theme(strip.text.x=element_blank(),
axis.title.y=element_blank()),
nrow=3,
heights=c(0.9,1.8,1.9))
testisp
# p <- annotate_figure(ggarrange(ovaryp, testisp, ncol=2),
#                      between=text_grob("|", color = "black", face = "bold", size = 20))
line <- "________________________________________________________________________________________________________________________________________________________________________"
p <- ggarrange(annotate_figure(ovaryp,
right=text_grob(line,
size=9,
rot=90)),
testisp,
ncol=2)
p
## the hill
## change x axis titles to something like %5mC and log(counts) ...
## ...and then add annotations for "Expression", "Methylation", and "Correlations"
## add legend on bottom
##
testisp <- ggarrange(ggarrange(NULL,
annotate_figure(expression_testis+
scale_y_continuous(labels = label_number(scale = 1, accuracy = 0.1))+
theme(axis.title.x=element_blank(),
axis.title.y=element_blank(),
plot.title = element_text(hjust = 0.5))+
ggtitle("Testis-associated genes"),
right=text_grob("  Whole transcript", size=9, rot=270, vjust=1)),
NULL,
nrow=1,
widths=c(0.0005,1,0.005)),
meth_testis+
theme(strip.text.x=element_blank(),
axis.title.y=element_blank()),
corr_testis+
scale_y_continuous(labels = label_number(scale = 1, accuracy = 0.1))+
theme(strip.text.x=element_blank(),
axis.title.y=element_blank()),
nrow=3,
heights=c(0.9,1.8,1.8))
testisp
testisp <- ggarrange(ggarrange(NULL,
annotate_figure(expression_testis+
scale_y_continuous(labels = label_number(scale = 1, accuracy = 0.1))+
theme(axis.title.x=element_blank(),
axis.title.y=element_blank(),
plot.title = element_text(hjust = 0.5))+
ggtitle("Testis-associated genes"),
right=text_grob("  Whole transcript", size=9, rot=270, vjust=1)),
NULL,
nrow=1,
widths=c(0.0005,1,0.005)),
meth_testis+
theme(strip.text.x=element_blank(),
axis.title.y=element_blank()),
corr_testis+
scale_y_continuous(labels = label_number(scale = 1, accuracy = 0.1))+
theme(strip.text.x=element_blank(),
axis.title.y=element_blank()),
nrow=3,
heights=c(0.9,1.7,1.7))
testisp
ovaryp <- ggarrange(ggarrange(NULL,
expression_ovary+
scale_y_continuous(labels = label_number(scale = 1, accuracy = 0.1))+
theme(axis.title.x=element_blank(),
plot.title = element_text(hjust = 0.5))+
ggtitle("Ovary-associated genes"),
NULL,
nrow=1,
widths=c(0.001,1,0)),
meth_ovary+
theme(strip.text.x=element_blank(),
strip.text.y=element_blank()),
corr_ovary+
scale_y_continuous(labels = label_number(scale = 1, accuracy = 0.1))+
theme(strip.text.x=element_blank(),
strip.text.y=element_blank()),
nrow=3,
heights=c(0.9,1.7,1.7))
ovaryp
testisp <- ggarrange(ggarrange(NULL,
annotate_figure(expression_testis+
scale_y_continuous(labels = label_number(scale = 1, accuracy = 0.1))+
theme(axis.title.x=element_blank(),
axis.title.y=element_blank(),
plot.title = element_text(hjust = 0.5))+
ggtitle("Testis-associated genes"),
right=text_grob("  Whole transcript", size=9, rot=270, vjust=1)),
NULL,
nrow=1,
widths=c(0.0005,1,0.005)),
meth_testis+
theme(strip.text.x=element_blank(),
axis.title.y=element_blank()),
corr_testis+
scale_y_continuous(labels = label_number(scale = 1, accuracy = 0.1))+
theme(strip.text.x=element_blank(),
axis.title.y=element_blank()),
nrow=3,
heights=c(0.9,1.7,1.7))
testisp
# p <- annotate_figure(ggarrange(ovaryp, testisp, ncol=2),
#                      between=text_grob("|", color = "black", face = "bold", size = 20))
line <- "________________________________________________________________________________________________________________________________________________________________________"
p <- ggarrange(annotate_figure(ovaryp,
right=text_grob(line,
size=9,
rot=90)),
testisp,
ncol=2)
p
## the hill
## change x axis titles to something like %5mC and log(counts) ...
## ...and then add annotations for "Expression", "Methylation", and "Correlations"
## add legend on bottom
##
testisp <- ggarrange(ggarrange(NULL,
annotate_figure(expression_testis+
scale_y_continuous(labels = label_number(scale = 1, accuracy = 0.1))+
theme(axis.title.x=element_blank(),
axis.title.y=element_blank(),
plot.title = element_text(hjust = 0.5))+
ggtitle("Testis-associated genes"),
right=text_grob("  Whole transcript", size=9, rot=270, vjust=1)),
NULL,
nrow=1,
widths=c(0.0005,1,0.005)),
meth_testis+
theme(strip.text.x=element_blank(),
axis.title.y=element_blank()),
corr_testis+
scale_y_continuous(labels = label_number(scale = 1, accuracy = 0.1))+
theme(strip.text.x=element_blank(),
axis.title.y=element_blank()),
nrow=3,
heights=c(0.9,1.7,2))
testisp
ovaryp <- ggarrange(ggarrange(NULL,
expression_ovary+
scale_y_continuous(labels = label_number(scale = 1, accuracy = 0.1))+
theme(axis.title.x=element_blank(),
plot.title = element_text(hjust = 0.5))+
ggtitle("Ovary-associated genes"),
NULL,
nrow=1,
widths=c(0.001,1,0)),
meth_ovary+
theme(strip.text.x=element_blank(),
strip.text.y=element_blank()),
corr_ovary+
scale_y_continuous(labels = label_number(scale = 1, accuracy = 0.1))+
theme(strip.text.x=element_blank(),
strip.text.y=element_blank()),
nrow=3,
heights=c(0.9,1.7,2))
ovaryp
# p <- annotate_figure(ggarrange(ovaryp, testisp, ncol=2),
#                      between=text_grob("|", color = "black", face = "bold", size = 20))
line <- "________________________________________________________________________________________________________________________________________________________________________"
p <- ggarrange(annotate_figure(ovaryp,
right=text_grob(line,
size=9,
rot=90)),
testisp,
ncol=2)
p
## the hill
## change x axis titles to something like %5mC and log(counts) ...
## ...and then add annotations for "Expression", "Methylation", and "Correlations"
## add legend on bottom
##
testisp <- ggarrange(ggarrange(NULL,
annotate_figure(expression_testis+
scale_y_continuous(labels = label_number(scale = 1, accuracy = 0.1))+
theme(axis.title.x=element_blank(),
axis.title.y=element_blank(),
plot.title = element_text(hjust = 0.5))+
ggtitle("Testis-associated genes"),
right=text_grob("  Whole transcript", size=9, rot=270, vjust=1)),
NULL,
nrow=1,
widths=c(0.0005,1,0.005)),
meth_testis+
theme(strip.text.x=element_blank(),
axis.title.y=element_blank()),
corr_testis+
scale_y_continuous(labels = label_number(scale = 1, accuracy = 0.1))+
theme(strip.text.x=element_blank(),
axis.title.y=element_blank()),
nrow=3,
heights=c(0.8,1.7,2))
testisp
ovaryp <- ggarrange(ggarrange(NULL,
expression_ovary+
scale_y_continuous(labels = label_number(scale = 1, accuracy = 0.1))+
theme(axis.title.x=element_blank(),
plot.title = element_text(hjust = 0.5))+
ggtitle("Ovary-associated genes"),
NULL,
nrow=1,
widths=c(0.001,1,0)),
meth_ovary+
theme(strip.text.x=element_blank(),
strip.text.y=element_blank()),
corr_ovary+
scale_y_continuous(labels = label_number(scale = 1, accuracy = 0.1))+
theme(strip.text.x=element_blank(),
strip.text.y=element_blank()),
nrow=3,
heights=c(0.8,1.7,2))
ovaryp
# p <- annotate_figure(ggarrange(ovaryp, testisp, ncol=2),
#                      between=text_grob("|", color = "black", face = "bold", size = 20))
line <- "________________________________________________________________________________________________________________________________________________________________________"
p <- ggarrange(annotate_figure(ovaryp,
right=text_grob(line,
size=9,
rot=90)),
testisp,
ncol=2)
p
## the hill
## change x axis titles to something like %5mC and log(counts) ...
## ...and then add annotations for "Expression", "Methylation", and "Correlations"
## add legend on bottom
##
testisp <- ggarrange(ggarrange(NULL,
annotate_figure(expression_testis+
scale_y_continuous(labels = label_number(scale = 1, accuracy = 0.1))+
theme(axis.title.x=element_blank(),
axis.title.y=element_blank(),
plot.title = element_text(hjust = 0.5))+
ggtitle("Testis-associated genes"),
right=text_grob("  Whole transcript", size=9, rot=270, vjust=1)),
NULL,
nrow=1,
widths=c(0.0005,1,0.005)),
meth_testis+
theme(strip.text.x=element_blank(),
axis.title.y=element_blank()),
corr_testis+
scale_y_continuous(labels = label_number(scale = 1, accuracy = 0.1))+
theme(strip.text.x=element_blank(),
axis.title.y=element_blank()),
nrow=3,
heights=c(0.85,1.75,2))
testisp
ovaryp <- ggarrange(ggarrange(NULL,
expression_ovary+
scale_y_continuous(labels = label_number(scale = 1, accuracy = 0.1))+
theme(axis.title.x=element_blank(),
plot.title = element_text(hjust = 0.5))+
ggtitle("Ovary-associated genes"),
NULL,
nrow=1,
widths=c(0.001,1,0)),
meth_ovary+
theme(strip.text.x=element_blank(),
strip.text.y=element_blank()),
corr_ovary+
scale_y_continuous(labels = label_number(scale = 1, accuracy = 0.1))+
theme(strip.text.x=element_blank(),
strip.text.y=element_blank()),
nrow=3,
heights=c(0.85,1.75,2))
ovaryp
testisp <- ggarrange(ggarrange(NULL,
annotate_figure(expression_testis+
scale_y_continuous(labels = label_number(scale = 1, accuracy = 0.1))+
theme(axis.title.x=element_blank(),
axis.title.y=element_blank(),
plot.title = element_text(hjust = 0.5))+
ggtitle("Testis-associated genes"),
right=text_grob("  Whole transcript", size=9, rot=270, vjust=1)),
NULL,
nrow=1,
widths=c(0.0005,1,0.005)),
meth_testis+
theme(strip.text.x=element_blank(),
axis.title.y=element_blank()),
corr_testis+
scale_y_continuous(labels = label_number(scale = 1, accuracy = 0.1))+
theme(strip.text.x=element_blank(),
axis.title.y=element_blank()),
nrow=3,
heights=c(0.85,1.75,2))
testisp
# p <- annotate_figure(ggarrange(ovaryp, testisp, ncol=2),
#                      between=text_grob("|", color = "black", face = "bold", size = 20))
line <- "________________________________________________________________________________________________________________________________________________________________________"
p <- ggarrange(annotate_figure(ovaryp,
right=text_grob(line,
size=9,
rot=90)),
testisp,
ncol=2)
p
## the hill
## change x axis titles to something like %5mC and log(counts) ...
## ...and then add annotations for "Expression", "Methylation", and "Correlations"
## add legend on bottom
##
